<script>
function enviar() {
  const nome = document.getElementById("nome").value;
  const email = document.getElementById("email").value;
  const percentual = document.getElementById("percentual").value;

  if (!nome || !email) {
    alert("Preencha nome e email.");
    return;
  }

  const dados = {
    nome: nome,
    email: email,
    percentual: percentual,
    valor: percentual * 50
  };

  document.getElementById("status").innerHTML = "â³ Gerando contrato...";

  fetch("https://script.google.com/macros/s/AKfycbzxgi2esV01dJIuLvJ1xB5kHl0tskhbFzLI4Vadx9BGw3yDyREWGZimeo0XHewTOQo/exec", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify(dados)
  })
  .then(res => res.json())
  .then(resp => {
    if (resp.status === "ok") {
      document.getElementById("status").innerHTML =
        `âœ… Contrato gerado com sucesso.<br>
         <a href="${resp.contrato}" target="_blank">
         ğŸ“„ Abrir contrato</a>`;
    } else {
      document.getElementById("status").innerHTML =
        "âŒ Erro: " + resp.mensagem;
    }
  })
  .catch(err => {
    document.getElementById("status").innerHTML =
      "âŒ Falha ao conectar com o servidor.";
    console.error(err);
  });
}
</script>
