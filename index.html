<script>
function enviar() {
  const nome = document.getElementById("nome").value.trim();
  const email = document.getElementById("email").value.trim();
  const percentual = document.getElementById("percentual").value;

  if (!nome || !email) {
    alert("Preencha nome e email.");
    return;
  }

  const params = new URLSearchParams();
  params.append("nome", nome);
  params.append("email", email);
  params.append("musica", "Sons da Rua");
  params.append("isrc", "BR-XYZ-26-00001");
  params.append("percentual", percentual);
  params.append("valor", percentual * 50);
  params.append("pagamento", "DEMO");

  const status = document.getElementById("status");
  status.innerText = "â³ Gerando contrato, aguarde...";

  fetch("https://script.google.com/macros/s/AKfycbz1RJ7w_gSoJRU3tcOsi_Zvtlj0HrqriTRFJlhq7awVFWOx16Jmgm-OISBPIefwU2Dm/exec", {
    method: "POST",
    body: params
  })
  .then(res => res.json())
  .then(resp => {
    if (resp.status === "ok") {
      status.innerHTML =
        `âœ… Contrato gerado com sucesso.<br><br>
         <a href="${resp.contrato}" target="_blank" style="color:#4fd1c5;">
         ğŸ“„ Baixar contrato PDF</a>`;
    } else {
      status.innerText = "âŒ Erro: " + resp.mensagem;
    }
  })
  .catch(err => {
    status.innerText = "âŒ Falha na conexÃ£o com o servidor.";
    console.error(err);
  });
}
</script>
