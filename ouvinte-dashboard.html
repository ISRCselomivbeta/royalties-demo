// Inicializa API YouTube com configurações de permissão
        function onYouTubeIframeAPIReady() {
            ytPlayer = new YT.Player('yt-hidden-engine', {
                height: '0', width: '0',
                playerVars: {
                    'autoplay': 1,
                    'playsinline': 1,
                    'mute': 1 // Começa mudo para contornar bloqueio de navegadores
                },
                events: { 
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange 
                }
            });
        }

        function onPlayerReady(event) {
            console.log("Player pronto para minerar");
        }

        function onPlayerStateChange(event) {
            // Se o usuário pausar o vídeo manualmente na barra, paramos o timer
            if (event.data == YT.PlayerState.PAUSED) {
                clearInterval(timerInterval);
                document.getElementById('playerStatus').innerText = "Música Pausada";
            }
            // Se ele der play novamente
            if (event.data == YT.PlayerState.PLAYING) {
                retomarTimer();
            }
        }

        function playMusic(id, tit, thumb) {
            musicaAtivaId = id;
            const playerArea = document.getElementById('playerArea');
            playerArea.style.display = 'block';
            document.getElementById('playerTitle').innerText = tit;
            document.getElementById('playerThumb').src = thumb;
            document.getElementById('playerStatus').innerText = "Minerando...";
            
            // Carrega e tenta tocar
            ytPlayer.loadVideoById(id);
            ytPlayer.unMute(); // Tenta tirar o mudo após a interação do clique
            ytPlayer.setVolume(100);
            ytPlayer.playVideo();

            iniciarTimer();
        }

        let tempoRestante = 30;
        function iniciarTimer() {
            tempoRestante = 30;
            clearInterval(timerInterval);
            document.getElementById('barraProgresso').style.width = '0%';
            
            timerInterval = setInterval(() => {
                if(ytPlayer.getPlayerState() === YT.PlayerState.PLAYING) {
                    tempoRestante--;
                    let progresso = ((30 - tempoRestante) / 30) * 100;
                    document.getElementById('barraProgresso').style.width = progresso + '%';
                    document.getElementById('timerTxt').innerText = `00:${tempoRestante < 10 ? '0'+tempoRestante : tempoRestante}`;

                    if(tempoRestante <= 0) {
                        clearInterval(timerInterval);
                        finalizarMineração();
                    }
                }
            }, 1000);
        }

        function retomarTimer() {
            document.getElementById('playerStatus').innerText = "Minerando...";
            // Lógica para continuar de onde parou se necessário
        }
